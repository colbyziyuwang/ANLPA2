Evaluating on 150 test files
Evaluating files:   0%|          | 0/150 [00:00<?, ?it/s]Evaluating files:   1%|          | 1/150 [00:29<1:13:45, 29.70s/it]Evaluating files:   1%|▏         | 2/150 [00:47<55:35, 22.54s/it]  Evaluating files:   2%|▏         | 3/150 [01:14<1:00:52, 24.85s/it]Evaluating files:   3%|▎         | 4/150 [01:32<53:35, 22.02s/it]  Evaluating files:   3%|▎         | 5/150 [01:58<56:17, 23.29s/it]Evaluating files:   4%|▍         | 6/150 [02:23<57:46, 24.07s/it]Evaluating files:   5%|▍         | 7/150 [02:49<58:38, 24.60s/it]Evaluating files:   5%|▌         | 8/150 [03:15<59:06, 24.97s/it]Evaluating files:   6%|▌         | 9/150 [03:40<59:14, 25.21s/it]Evaluating files:   7%|▋         | 10/150 [04:06<59:12, 25.37s/it]Evaluating files:   7%|▋         | 11/150 [04:32<59:03, 25.49s/it]Evaluating files:   8%|▊         | 12/150 [04:58<58:49, 25.58s/it]Evaluating files:   9%|▊         | 13/150 [05:23<58:02, 25.42s/it]Evaluating files:   9%|▉         | 14/150 [05:29<44:37, 19.68s/it]Evaluating files:  10%|█         | 15/150 [05:55<48:14, 21.44s/it]Evaluating files:  11%|█         | 16/150 [06:20<50:48, 22.75s/it]Evaluating files:  11%|█▏        | 17/150 [06:46<52:19, 23.61s/it]Evaluating files:  12%|█▏        | 18/150 [07:12<53:30, 24.32s/it]Evaluating files:  13%|█▎        | 19/150 [07:39<54:36, 25.02s/it]Evaluating files:  13%|█▎        | 20/150 [08:06<55:27, 25.59s/it]Evaluating files:  14%|█▍        | 21/150 [08:22<48:58, 22.78s/it]Evaluating files:  15%|█▍        | 22/150 [08:49<51:29, 24.13s/it]Evaluating files:  15%|█▌        | 23/150 [09:16<52:38, 24.87s/it]Evaluating files:  16%|█▌        | 24/150 [09:43<53:32, 25.49s/it]Evaluating files:  17%|█▋        | 25/150 [10:10<53:59, 25.91s/it]Evaluating files:  17%|█▋        | 26/150 [10:36<54:13, 26.24s/it]Evaluating files:  18%|█▊        | 27/150 [11:01<52:32, 25.63s/it]Evaluating files:  19%|█▊        | 28/150 [11:12<43:25, 21.36s/it]Evaluating files:  19%|█▉        | 29/150 [11:37<45:06, 22.37s/it]Evaluating files:  20%|██        | 30/150 [11:48<38:16, 19.13s/it]Evaluating files:  21%|██        | 31/150 [12:15<42:19, 21.34s/it]Evaluating files:  21%|██▏       | 32/150 [12:42<45:04, 22.92s/it]Evaluating files:  22%|██▏       | 33/150 [13:08<46:48, 24.00s/it]Evaluating files:  23%|██▎       | 34/150 [13:36<48:28, 25.07s/it]Evaluating files:  23%|██▎       | 35/150 [14:02<48:53, 25.51s/it]Evaluating files:  24%|██▍       | 36/150 [14:29<49:03, 25.82s/it]Evaluating files:  25%|██▍       | 37/150 [14:55<49:08, 26.10s/it]Evaluating files:  25%|██▌       | 38/150 [15:22<49:03, 26.28s/it]Evaluating files:  26%|██▌       | 39/150 [15:49<48:47, 26.38s/it]Evaluating files:  27%|██▋       | 40/150 [16:15<48:06, 26.24s/it]Evaluating files:  27%|██▋       | 41/150 [16:40<47:27, 26.12s/it]Evaluating files:  28%|██▊       | 42/150 [17:07<47:19, 26.29s/it]Evaluating files:  29%|██▊       | 43/150 [17:34<47:12, 26.47s/it]Evaluating files:  29%|██▉       | 44/150 [18:01<46:47, 26.48s/it]Evaluating files:  30%|███       | 45/150 [18:28<46:47, 26.73s/it]Evaluating files:  31%|███       | 46/150 [18:55<46:21, 26.74s/it]Evaluating files:  31%|███▏      | 47/150 [19:08<39:07, 22.79s/it]Evaluating files:  32%|███▏      | 48/150 [19:35<40:41, 23.94s/it]Evaluating files:  33%|███▎      | 49/150 [19:49<35:06, 20.85s/it]Evaluating files:  33%|███▎      | 50/150 [20:15<37:32, 22.53s/it]Evaluating files:  34%|███▍      | 51/150 [20:43<40:00, 24.25s/it]Evaluating files:  35%|███▍      | 52/150 [20:55<33:28, 20.50s/it]Evaluating files:  35%|███▌      | 53/150 [21:31<40:30, 25.06s/it]Evaluating files:  36%|███▌      | 54/150 [22:03<43:40, 27.29s/it]Evaluating files:  37%|███▋      | 55/150 [22:36<45:54, 29.00s/it]Evaluating files:  37%|███▋      | 56/150 [23:12<48:29, 30.95s/it]Evaluating files:  38%|███▊      | 57/150 [23:46<49:20, 31.83s/it]Evaluating files:  39%|███▊      | 58/150 [24:18<48:54, 31.90s/it]Evaluating files:  39%|███▉      | 59/150 [24:51<49:02, 32.34s/it]Evaluating files:  40%|████      | 60/150 [25:27<50:00, 33.33s/it]Evaluating files:  41%|████      | 61/150 [25:56<47:40, 32.14s/it]Evaluating files:  41%|████▏     | 62/150 [26:30<47:53, 32.65s/it]Evaluating files:  42%|████▏     | 63/150 [27:02<47:15, 32.59s/it]Evaluating files:  43%|████▎     | 64/150 [27:37<47:31, 33.16s/it]Evaluating files:  43%|████▎     | 65/150 [27:51<39:04, 27.58s/it]Evaluating files:  44%|████▍     | 66/150 [28:06<33:05, 23.64s/it]Evaluating files:  45%|████▍     | 67/150 [28:37<35:42, 25.81s/it]Evaluating files:  45%|████▌     | 68/150 [28:45<28:07, 20.57s/it]Evaluating files:  46%|████▌     | 69/150 [29:10<29:45, 22.05s/it]Evaluating files:  47%|████▋     | 70/150 [29:36<30:54, 23.18s/it]Evaluating files:  47%|████▋     | 71/150 [30:02<31:28, 23.91s/it]Evaluating files:  48%|████▊     | 72/150 [30:28<31:50, 24.49s/it]Evaluating files:  49%|████▉     | 74/150 [30:53<24:13, 19.12s/it]Evaluating files:  50%|█████     | 75/150 [31:04<21:06, 16.89s/it]Evaluating files:  51%|█████     | 76/150 [31:29<23:37, 19.16s/it]Evaluating files:  51%|█████▏    | 77/150 [31:55<25:28, 20.94s/it]Evaluating files:  52%|█████▏    | 78/150 [32:21<26:42, 22.26s/it]Evaluating files:  53%|█████▎    | 79/150 [32:46<27:26, 23.19s/it]Evaluating files:  53%|█████▎    | 80/150 [33:12<27:53, 23.91s/it]Evaluating files:  54%|█████▍    | 81/150 [33:33<26:41, 23.21s/it]Evaluating files:  55%|█████▍    | 82/150 [33:59<27:19, 24.11s/it]Evaluating files:  55%|█████▌    | 83/150 [34:26<27:41, 24.79s/it]Evaluating files:  56%|█████▌    | 84/150 [34:46<25:44, 23.41s/it]Evaluating files:  57%|█████▋    | 85/150 [35:10<25:35, 23.62s/it]Evaluating files:  57%|█████▋    | 86/150 [35:32<24:31, 22.99s/it]Evaluating files:  58%|█████▊    | 87/150 [35:58<25:11, 23.99s/it]Evaluating files:  59%|█████▊    | 88/150 [36:25<25:34, 24.74s/it]Evaluating files:  59%|█████▉    | 89/150 [36:52<25:59, 25.57s/it]Evaluating files:  60%|██████    | 90/150 [37:19<26:06, 26.10s/it]Evaluating files:  61%|██████    | 91/150 [37:46<25:56, 26.37s/it]Evaluating files:  61%|██████▏   | 92/150 [38:07<23:46, 24.59s/it]Evaluating files:  62%|██████▏   | 93/150 [38:32<23:32, 24.78s/it]Evaluating files:  63%|██████▎   | 94/150 [38:59<23:36, 25.30s/it]Evaluating files:  63%|██████▎   | 95/150 [39:04<17:44, 19.35s/it]Evaluating files:  64%|██████▍   | 96/150 [39:31<19:23, 21.55s/it]Evaluating files:  65%|██████▍   | 97/150 [39:58<20:28, 23.18s/it]Evaluating files:  65%|██████▌   | 98/150 [40:23<20:37, 23.79s/it]Evaluating files:  66%|██████▌   | 99/150 [40:50<21:04, 24.80s/it]Evaluating files:  67%|██████▋   | 100/150 [41:17<21:09, 25.39s/it]Evaluating files:  67%|██████▋   | 101/150 [41:44<21:15, 26.03s/it]Evaluating files:  68%|██████▊   | 102/150 [42:05<19:29, 24.36s/it]Evaluating files:  69%|██████▊   | 103/150 [42:31<19:36, 25.03s/it]Evaluating files:  69%|██████▉   | 104/150 [42:58<19:37, 25.60s/it]Evaluating files:  70%|███████   | 105/150 [43:25<19:23, 25.85s/it]Evaluating files:  71%|███████   | 106/150 [43:50<18:43, 25.54s/it]Evaluating files:  71%|███████▏  | 107/150 [44:17<18:43, 26.12s/it]Evaluating files:  72%|███████▏  | 108/150 [44:44<18:30, 26.43s/it]Evaluating files:  73%|███████▎  | 110/150 [45:11<13:38, 20.47s/it]Evaluating files:  74%|███████▍  | 111/150 [45:38<14:16, 21.97s/it]Evaluating files:  75%|███████▍  | 112/150 [45:44<11:23, 17.99s/it]Evaluating files:  75%|███████▌  | 113/150 [45:56<10:03, 16.31s/it]Evaluating files:  76%|███████▌  | 114/150 [46:27<12:14, 20.40s/it]Evaluating files:  77%|███████▋  | 115/150 [47:03<14:30, 24.88s/it]Evaluating files:  77%|███████▋  | 116/150 [47:39<15:56, 28.14s/it]Evaluating files:  78%|███████▊  | 117/150 [48:16<16:45, 30.47s/it]Evaluating files:  79%|███████▊  | 118/150 [48:52<17:11, 32.24s/it]Evaluating files:  79%|███████▉  | 119/150 [49:28<17:13, 33.35s/it]Evaluating files:  80%|████████  | 120/150 [49:47<14:29, 28.99s/it]Evaluating files:  81%|████████  | 121/150 [50:21<14:44, 30.48s/it]Evaluating files:  81%|████████▏ | 122/150 [50:55<14:48, 31.73s/it]Evaluating files:  82%|████████▏ | 123/150 [51:20<13:16, 29.51s/it]Evaluating files:  83%|████████▎ | 124/150 [51:56<13:38, 31.47s/it]Evaluating files:  83%|████████▎ | 125/150 [52:30<13:28, 32.36s/it]Evaluating files:  84%|████████▍ | 126/150 [53:05<13:12, 33.03s/it]Evaluating files:  85%|████████▍ | 127/150 [53:39<12:50, 33.52s/it]Evaluating files:  85%|████████▌ | 128/150 [54:14<12:24, 33.82s/it]Evaluating files:  86%|████████▌ | 129/150 [54:48<11:49, 33.80s/it]Evaluating files:  87%|████████▋ | 130/150 [55:23<11:25, 34.28s/it]Evaluating files:  87%|████████▋ | 131/150 [55:37<08:55, 28.17s/it]Evaluating files:  88%|████████▊ | 132/150 [55:49<07:02, 23.45s/it]Evaluating files:  89%|████████▊ | 133/150 [56:26<07:43, 27.25s/it]Evaluating files:  89%|████████▉ | 134/150 [57:02<08:02, 30.16s/it]Evaluating files:  90%|█████████ | 135/150 [57:31<07:25, 29.70s/it]Evaluating files:  91%|█████████ | 136/150 [58:07<07:21, 31.55s/it]Evaluating files:  91%|█████████▏| 137/150 [58:43<07:06, 32.83s/it]Evaluating files:  92%|█████████▏| 138/150 [59:17<06:39, 33.29s/it]Evaluating files:  93%|█████████▎| 139/150 [59:53<06:13, 33.94s/it]Evaluating files:  93%|█████████▎| 140/150 [1:00:20<05:18, 31.89s/it]Evaluating files:  94%|█████████▍| 141/150 [1:00:54<04:54, 32.69s/it]Evaluating files:  95%|█████████▍| 142/150 [1:01:29<04:27, 33.44s/it]Evaluating files:  95%|█████████▌| 143/150 [1:02:04<03:55, 33.69s/it]Evaluating files:  96%|█████████▌| 144/150 [1:02:39<03:24, 34.16s/it]Evaluating files:  97%|█████████▋| 145/150 [1:03:14<02:52, 34.48s/it]Evaluating files:  97%|█████████▋| 146/150 [1:03:21<01:44, 26.22s/it]Evaluating files:  98%|█████████▊| 147/150 [1:03:47<01:18, 26.02s/it]Evaluating files:  99%|█████████▊| 148/150 [1:04:11<00:51, 25.54s/it]Evaluating files:  99%|█████████▉| 149/150 [1:04:46<00:28, 28.25s/it]Evaluating files: 100%|██████████| 150/150 [1:05:21<00:00, 30.41s/it]Evaluating files: 100%|██████████| 150/150 [1:05:21<00:00, 26.14s/it]
/Users/colbywang/Desktop/ANLPA2/rag/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1565: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
/Users/colbywang/Desktop/ANLPA2/rag/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1565: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
/Users/colbywang/Desktop/ANLPA2/rag/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1565: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))

🔹 Evaluation Metrics 🔹
✅ Accuracy: 0.7604
📏 Precision: 0.5782
📡 Recall: 0.7604
⚖️ F1 Score: 0.6569

🔹 Detailed Classification Report 🔹
              precision    recall  f1-score   support

           0     0.7604    1.0000    0.8639    634752
           1     0.0000    0.0000    0.0000    103496
           2     0.0000    0.0000    0.0000     96487

    accuracy                         0.7604    834735
   macro avg     0.2535    0.3333    0.2880    834735
weighted avg     0.5782    0.7604    0.6569    834735


🔹 Confusion Matrix 🔹
[[634752      0      0]
 [103496      0      0]
 [ 96487      0      0]]

✅ Confusion matrix saved to 'images/confusion_matrix_transformer.png'
